webpackJsonp([42861642506013],{476:function(n,s){n.exports={data:{site:{siteMetadata:{title:"Ryan Oglesby"}},markdownRemark:{id:"/Users/ryanoglesby/Projects/blog/src/src/pages/exposing-css-hidden-complexities-with-react/index.md absPath of file >>> MarkdownRemark",html:'<p>When we create web applications we use style sheets to describe presentation, and we use JavaScript\nto manage all the bits of state and logic. Unfortunately, we often end up with style sheets full of\ncomplexity, such as stateful pseudo-classes, style rule overrides through media queries, and\ndeceivingly complicated animations. But what if we could leverage the expressiveness of React to\ntake control of all of this?</p>\n<blockquote>\n<p>Complexity is a concern better handled with JavaScript, not style sheets. If we push complexity\nfrom style sheets into JavaScript, then it becomes more obvious and predictable, thus easier to\ndeal with.</p>\n</blockquote>\n<p>This post is an exploration of this hypothesis applied to 3 common CSS features:</p>\n<ol>\n<li>Pseudo-classes</li>\n<li>Media queries</li>\n<li>Animations</li>\n</ol>\n<p><em>I’ve also created an accompanying\n<a href="https://github.com/ryanoglesby08/exposing-css-hidden-complexities">Github repo</a> with full, working\nexamples of all the snippets shown in this post.</em></p>\n<!-- more -->\n<h2>Motivation</h2>\n<p>While evaluating CSS-in-JS libraries for my current project recently, I did a\n<a href="https://github.com/ryanoglesby08/react-native-web-poc">deep dive</a> on\n<a href="https://github.com/necolas/react-native-web">React Native for Web</a>. The library’s philosophy and\ndirection really resonated with me, and like many CSS-in-JS implementations it has many benefits\nover traditional CSS at scale. If you haven’t seen it yet check it out!</p>\n<p>The <a href="https://github.com/necolas/react-native-web/blob/master/docs/guides/style.md#faqs">Style FAQs</a>\nin the documentation caught my eye:</p>\n<p><em>“Media Queries may not be most appropriate for component-based designs. React Native provides the\nDimensions API and onLayout props. If you do need Media Queries, using the matchMedia DOM API has\nthe benefit of allowing you to swap out entire components, not just styles.”</em></p>\n<p><em>“Pseudo-classes like :hover and :focus can be implemented with events (e.g. onFocus).\nPseudo-elements are not supported; elements should be used instead.”</em></p>\n<p>Because React Native for Web relies on React Native implementations to be cross-platform compatible,\nit eschews some CSS features in favor of JavaScript implementations. This makes a lot of sense even\nif you are not trying to build a cross-platform app. So, I decided to explore this concept further,\nwithout using React Native for Web.</p>\n<h2>A “simple” button</h2>\n<p>Here is the example I’ll be using, a “simple” button component and its accompanying style sheet.</p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code class="language-css"><span class="token comment">/* Button.css */</span>\n\n<span class="token selector">button</span> <span class="token punctuation">{</span>\n  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>\n  <span class="token property">min-width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>\n\n  <span class="token property">background-color</span><span class="token punctuation">:</span> #2892d7<span class="token punctuation">;</span>\n  <span class="token property">transition</span><span class="token punctuation">:</span> background-color 0.5s<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">button:hover</span> <span class="token punctuation">{</span>\n  <span class="token property">background-color</span><span class="token punctuation">:</span> #1d70a2<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">max-width</span><span class="token punctuation">:</span> 767px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>\n  <span class="token selector">button</span> <span class="token punctuation">{</span>\n    <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>\n    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Button.js</span>\n\n<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>\n\n<span class="token keyword">import</span> <span class="token string">"./Button.css"</span><span class="token punctuation">;</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>button<span class="token operator">></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span><span class="token punctuation">;</span>\n<span class="token punctuation">)</span></code></pre>\n      </div>\n<p><em>Full component:\n<a href="https://github.com/ryanoglesby08/exposing-css-hidden-complexities/tree/master/src/components/CssButton">https://github.com/ryanoglesby08/exposing-css-hidden-complexities/tree/master/src/components/CssButton</a></em></p>\n<h2>Goodbye pseudo-classes, hello setState</h2>\n<p>First up is the <code class="language-text">:hover</code> pseudo-class. One of the key tenants of React and other UI libraries is\nthat they pull state out of the DOM and into your components so that it is easier to reason about.\nCSS Pseudo-classes are a direct contradiction to this advantage. In order for the button to change\nit’s background color, something must know whether or not the mouse is currently “hovering” over the\nbutton. The DOM is doing that. The DOM is managing an implicit state of “mouse is over the button”\nor “mouse is not over the button”. The component should be managing that state, not the DOM.</p>\n<p>So, I’ll refactor the Button component to use the <code class="language-text">onMouseEnter</code> and <code class="language-text">onMouseLeave</code> events and\nReact’s <code class="language-text">setState</code>.</p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code class="language-css"><span class="token comment">/* Button.css */</span>\n\n<span class="token selector">button</span> <span class="token punctuation">{</span>\n  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>\n  <span class="token property">min-width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>\n\n  <span class="token property">transition</span><span class="token punctuation">:</span> background-color 0.5s<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">max-width</span><span class="token punctuation">:</span> 767px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>\n  <span class="token selector">button</span> <span class="token punctuation">{</span>\n    <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>\n    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Button.js</span>\n\n<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'react\'</span>\n\n<span class="token keyword">import</span> <span class="token string">\'./Button.css\'</span>\n<span class="token keyword">const</span> bgColors <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">\'#2892d7\'</span><span class="token punctuation">,</span>\n  hover<span class="token punctuation">:</span> <span class="token string">\'#1d70a2\'</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Button</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>\n  state <span class="token operator">=</span> <span class="token punctuation">{</span>\n    hover<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function-variable function">toggleHover</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> hover<span class="token punctuation">:</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>hover <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> <span class="token punctuation">{</span> children <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props\n\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token operator">&lt;</span>button\n        onMouseEnter<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>toggleHover<span class="token punctuation">}</span>\n        onMouseLeave<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>toggleHover<span class="token punctuation">}</span>\n        style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>\n          backgroundColor<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>hover <span class="token operator">?</span> bgColors<span class="token punctuation">.</span>hover <span class="token punctuation">:</span> bgColors<span class="token punctuation">.</span><span class="token keyword">default</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span><span class="token punctuation">}</span>\n      <span class="token operator">></span>\n        <span class="token punctuation">{</span>children<span class="token punctuation">}</span>\n      <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>\n    <span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p><em>Full component:\n<a href="https://github.com/ryanoglesby08/exposing-css-hidden-complexities/tree/master/src/components/HoverButton">https://github.com/ryanoglesby08/exposing-css-hidden-complexities/tree/master/src/components/HoverButton</a></em></p>\n<h2>A more power media query</h2>\n<p>Media queries suffer from the same contradiction as pseudo-classes. There is an implicit state of\n“the media query is matched” or “the media query is not matched” that should be managed by\nJavaScript.</p>\n<p>While pure CSS media queries are powerful, they tend to result in overriding of previously defined\nstyle values, which can often cause unwanted side effects and mistakes due to specificity errors. As\nthe React Native for Web docs point out, they also are constrained to adjusting styles only. They\ncan’t be used to swap out entire components.</p>\n<p>Next, I’ll move the media queries out of the style sheet, preferring the\n<a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/matchMedia"><code class="language-text">window.matchMedia</code></a> DOM API\ninstead. <a href="https://github.com/reacttraining/react-media">react-media</a> is a nice little package that\nprovides a component interface for <code class="language-text">window.matchMedia</code>.</p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code class="language-css"><span class="token comment">/* Button.css */</span>\n\n<span class="token selector">button</span> <span class="token punctuation">{</span>\n  <span class="token property">transition</span><span class="token punctuation">:</span> background-color 0.5s<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.inline</span> <span class="token punctuation">{</span>\n  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>\n  <span class="token property">min-width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.fullWidth</span> <span class="token punctuation">{</span>\n  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>\n  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Button.js</span>\n\n<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'react\'</span>\n<span class="token keyword">import</span> Media <span class="token keyword">from</span> <span class="token string">\'react-media\'</span>\n\n<span class="token keyword">import</span> <span class="token string">\'./Button.css\'</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Button</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>\n  <span class="token comment">// same as previous Button.js snippet</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>Media query<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> maxWidth<span class="token punctuation">:</span> <span class="token number">767</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span>\n    <span class="token punctuation">{</span>matches <span class="token operator">=></span>\n      matches <span class="token operator">?</span> <span class="token punctuation">(</span>\n        <span class="token operator">&lt;</span>Button className<span class="token operator">=</span><span class="token string">"fullWidth"</span><span class="token operator">></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">></span>\n      <span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span>\n        <span class="token operator">&lt;</span>Button className<span class="token operator">=</span><span class="token string">"inline"</span><span class="token operator">></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">></span>\n      <span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n  <span class="token operator">&lt;</span><span class="token operator">/</span>Media<span class="token operator">></span>\n<span class="token punctuation">)</span></code></pre>\n      </div>\n<p><em>Full component:\n<a href="https://github.com/ryanoglesby08/exposing-css-hidden-complexities/tree/master/src/components/ResponsiveButton">https://github.com/ryanoglesby08/exposing-css-hidden-complexities/tree/master/src/components/ResponsiveButton</a></em></p>\n<h2>Animations as components</h2>\n<p>The final thing to tackle here is the <code class="language-text">transition</code>. For all but the most experienced CSS wizards out\nthere, CSS animations or transitions can be really challenging. Moreover, they require the\ncombination of multiple style rules working together.</p>\n<p>In this case, <code class="language-text">transition: background-color 0.5s</code> describes a state change of the property\n<code class="language-text">background-color</code>. When the <code class="language-text">background-color</code> property of the button changes to another value,\neither through a class being added or removed, or a style property being edited, the background will\nshift from its previous value to its new value over a timespan of 0.5 seconds. It’s pretty complex,\nand this is a very simple transition.</p>\n<p>Finally, I’ll bring the transition into the component with the\n<a href="https://reactcommunity.org/react-transition-group/">react-transition-group</a> package, which lets you\ndescribe a transition from one component state to another over time with a simple declarative API.</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// BgColorShift.js</span>\n\n<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">\'react\'</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> Transition <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'react-transition-group\'</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">defaultStyle</span> <span class="token operator">=</span> <span class="token punctuation">(</span>startBgColor<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>\n  transition<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`background-color </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>timeout<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ms`</span></span><span class="token punctuation">,</span>\n  backgroundColor<span class="token punctuation">:</span> startBgColor<span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">transitionStyles</span> <span class="token operator">=</span> endBgColor <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">{</span>\n    entering<span class="token punctuation">:</span> <span class="token punctuation">{</span> backgroundColor<span class="token punctuation">:</span> endBgColor <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    entered<span class="token punctuation">:</span> <span class="token punctuation">{</span> backgroundColor<span class="token punctuation">:</span> endBgColor <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> start<span class="token punctuation">,</span> end<span class="token punctuation">,</span> children<span class="token punctuation">,</span> <span class="token operator">...</span>rest <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n  <span class="token operator">&lt;</span>Transition <span class="token punctuation">{</span><span class="token operator">...</span>rest<span class="token punctuation">}</span><span class="token operator">></span>\n    <span class="token punctuation">{</span>status <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">const</span> styles <span class="token operator">=</span> <span class="token punctuation">{</span>\n        <span class="token operator">...</span><span class="token function">defaultStyle</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> rest<span class="token punctuation">.</span>timeout<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token operator">...</span><span class="token function">transitionStyles</span><span class="token punctuation">(</span>end<span class="token punctuation">)</span><span class="token punctuation">[</span>status<span class="token punctuation">]</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span>\n\n      <span class="token keyword">return</span> <span class="token function">children</span><span class="token punctuation">(</span>styles<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">}</span>\n  <span class="token operator">&lt;</span><span class="token operator">/</span>Transition<span class="token operator">></span>\n<span class="token punctuation">)</span></code></pre>\n      </div>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Button.js</span>\n\n<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'react\'</span>\n\n<span class="token keyword">import</span> BgColorShift <span class="token keyword">from</span> <span class="token string">\'./BgColorShift\'</span>\n\n<span class="token keyword">import</span> <span class="token string">\'./Button.css\'</span>\n<span class="token keyword">const</span> bgColors <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">\'#2892d7\'</span><span class="token punctuation">,</span>\n  hover<span class="token punctuation">:</span> <span class="token string">\'#1d70a2\'</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Button</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ... setState stuff</span>\n\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> <span class="token punctuation">{</span> className<span class="token punctuation">,</span> children <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props\n\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token operator">&lt;</span>BgColorShift\n        timeout<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">500</span><span class="token punctuation">}</span>\n        <span class="token keyword">in</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>hover<span class="token punctuation">}</span>\n        start<span class="token operator">=</span><span class="token punctuation">{</span>bgColors<span class="token punctuation">.</span><span class="token keyword">default</span><span class="token punctuation">}</span>\n        end<span class="token operator">=</span><span class="token punctuation">{</span>bgColors<span class="token punctuation">.</span>hover<span class="token punctuation">}</span>\n      <span class="token operator">></span>\n        <span class="token punctuation">{</span>bgColorStyles <span class="token operator">=></span> <span class="token punctuation">(</span>\n          <span class="token operator">&lt;</span>button\n            onMouseEnter<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>toggleHover<span class="token punctuation">}</span>\n            onMouseLeave<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>toggleHover<span class="token punctuation">}</span>\n            style<span class="token operator">=</span><span class="token punctuation">{</span>bgColorStyles<span class="token punctuation">}</span>\n          <span class="token operator">></span>\n            <span class="token punctuation">{</span>children<span class="token punctuation">}</span>\n          <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>\n        <span class="token punctuation">)</span><span class="token punctuation">}</span>\n      <span class="token operator">&lt;</span><span class="token operator">/</span>BgColorShift<span class="token operator">></span>\n    <span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// export default with the Media query component</span></code></pre>\n      </div>\n<p><em>Full component:\n<a href="https://github.com/ryanoglesby08/exposing-css-hidden-complexities/tree/master/src/components/AnimatedButton">https://github.com/ryanoglesby08/exposing-css-hidden-complexities/tree/master/src/components/AnimatedButton</a></em></p>\n<h2>I can write tests for this stuff now!</h2>\n<p>One of the big wins as I moved complexity into JavaScript was the increased level of testability.\nThere weren’t any tests that really made sense when all the UI behavior was implemented in a style\nsheet. Writing tests for these things takes some of the burden off of manual visual checks, creates\ndocumentation of the visual language, and helps prevent future regressions.</p>\n<p>Here are some of the tests:</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Button.spec.js</span>\n\n<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">\'changes background color on hover\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> button <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Button<span class="token operator">></span>Press me<span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">></span><span class="token punctuation">)</span>\n\n  button<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'mouseEnter\'</span><span class="token punctuation">)</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>button<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">\'button\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveStyle</span><span class="token punctuation">(</span><span class="token string">\'backgroundColor\'</span><span class="token punctuation">,</span> <span class="token string">\'#1d70a2\'</span><span class="token punctuation">)</span>\n\n  button<span class="token punctuation">.</span><span class="token function">simulate</span><span class="token punctuation">(</span><span class="token string">\'mouseLeave\'</span><span class="token punctuation">)</span>\n  <span class="token function">expect</span><span class="token punctuation">(</span>button<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">\'button\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveStyle</span><span class="token punctuation">(</span><span class="token string">\'backgroundColor\'</span><span class="token punctuation">,</span> <span class="token string">\'#2892d7\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">\'is full width on small viewports\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token comment">// Setup mock for `window.matchMedia` because test is running in jsdom</span>\n  <span class="token keyword">const</span> matchMedia <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n  matchMedia<span class="token punctuation">.</span><span class="token function">mockImplementation</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>\n    matches<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n    addListener<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n    removeListener<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n  global<span class="token punctuation">.</span>matchMedia <span class="token operator">=</span> matchMedia\n\n  <span class="token keyword">const</span> button <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Button<span class="token operator">></span>Press me<span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">></span><span class="token punctuation">)</span>\n\n  <span class="token function">expect</span><span class="token punctuation">(</span>button<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">\'button\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveClassName</span><span class="token punctuation">(</span><span class="token string">\'fullWidth\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>\n      </div>\n<h2>My insights</h2>\n<p>Maybe the most obvious “downside” here is that the total amount of code has increased, by a lot.\nI’ve written less CSS, but much more JavaScript, and I’ve added 2 third-party libraries… just to\nmake a button.</p>\n<p>Let’s be clear here, my stated goal was not to create the most clever, most terse button. It was to\nexpose complexities hidden in CSS so that I could identify complexity, reason about it more easily,\ncontrol it, and test it. React actually has similar goals. React has never said that it’s goal is to\nproduce solutions with minimal lines of code. Rather, it aims for declarative components,\npredictability, and JavaScript-controlled logic (<a href="https://reactjs.org/">https://reactjs.org/</a>). The most clever solution\nis often the least understandable.</p>\n<center>\n\t<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">This is what good real world React code often looks like. Nothing wrong with it being verbose and explicit. Don’t mistake terse for clean! <a href="https://t.co/qjB685FnuJ">https://t.co/qjB685FnuJ</a></p>&mdash; Dan Abramov (@dan_abramov) <a href="https://twitter.com/dan_abramov/status/931333632572252160?ref_src=twsrc%5Etfw">November 17, 2017</a></blockquote>\n</center>\n<h3>Pros and cons</h3>\n<ul>\n<li>If you regularly use your browser’s dev tools to debug/play with the styles of your components,\nthe JavaScript approach changes that a bit. For example, most dev tools let you trigger a\npseudo-class such as <code class="language-text">:hover</code>. That will no longer have a visible effect. Instead, use the\n<a href="https://github.com/facebook/react-devtools">React dev tools</a> to programmatically interact with\nyour components.</li>\n</ul>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/react-dev-tools-7bfc801bba635d0d25dc86d77acf53bf-61e7c.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 57.41239892183289%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABm0lEQVQoz5WSW27UQBBFvRLYCmwJiWWwhWwD/uGH/CChTEIensxM/Ohuv8bjR7vt2IeyM0FIRChj6bqqXN23blXZg4mbpOXbpuL8oea74Kv4N4llzo3TxHQCPLnFxy8hbz6teH92x7uzW96K/+FzMKeeCHn94zGNbNKKlWq4Nu2i9lI3hGW3KJxOVTiOI2PvXqx2KtlCOL/6fsD1PV3/SDdM2H5kGE9p9K+WrbUkJhEYkvyALhrirKasLcMgRZyj6zrc0fZS+Nl/xszxdKbDi6IIkxhipVCCKAxIJQ6CgCAM0VoJNIl8UyqWfEgqsT6ez7IMI2KUydBJgTeri2O1KNxt7jFKs88LlFyMpViaFpRlRVGUFPsDuZD0eY5tW+q6Xua2zPsIL91Ju7eGbLNGBz5R5BOGd6L6gao6kKQN5cGx3zsK2Xy83WHLEtt1/yyOeSk60Kx/+PjnV2wvVmx//cS/v8JfX7IWG6gtuYnJdCg2wr1E9CcWhc71mLXBXMfsQ8MgQx+GgUfbMnRWluBwtsG1NV1TLbn//VK/ARHPTCu9chJqAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Using the React Dev Tools"\n        title=""\n        src="/static/react-dev-tools-7bfc801bba635d0d25dc86d77acf53bf-fb8a0.png"\n        srcset="/static/react-dev-tools-7bfc801bba635d0d25dc86d77acf53bf-1a291.png 148w,\n/static/react-dev-tools-7bfc801bba635d0d25dc86d77acf53bf-2bc4a.png 295w,\n/static/react-dev-tools-7bfc801bba635d0d25dc86d77acf53bf-fb8a0.png 590w,\n/static/react-dev-tools-7bfc801bba635d0d25dc86d77acf53bf-526de.png 885w,\n/static/react-dev-tools-7bfc801bba635d0d25dc86d77acf53bf-fa2eb.png 1180w,\n/static/react-dev-tools-7bfc801bba635d0d25dc86d77acf53bf-61e7c.png 1484w"\n        sizes="(max-width: 590px) 100vw, 590px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ul>\n<li>\n<p>I get really nervous when I see CSS or Sass that has a lot of nesting and overriding of style\nrules. I like how the final CSS file I ended up with was flat. All style rules are static, there\nis no nesting, and nothing is overridden by another class. Ahhhhh, peace.</p>\n</li>\n<li>\n<p>I’m pretty excited about encapsulating common visual concerns into reusable components with a\nsingle responsibility. In this exploration I identified a reusable media query component and an\nanimation component that could be extracted. In another project I’ve started extracting layout\ncomponents such as <code class="language-text">Box</code> to control spacing, and <code class="language-text">Flexbox</code> to control 1-dimensional layout. Check\nout these libraries for more: <a href="https://sapegin.github.io/react-spaceman/">https://sapegin.github.io/react-spaceman/</a> and\n<a href="https://github.com/jxnblk/reflexbox">https://github.com/jxnblk/reflexbox</a>.</p>\n</li>\n<li>\n<p>Finally, I was not able to write a test for the transition that I was completely satisfied with.\nTransitions and animations are inherently time based, which does not play nicely with unit\ntesting. The best I could do was take before and after snapshots and then rely on manual visual\nchecks to make sure the transition looked proper while it was running. But, with a reusable\n<code class="language-text">BgColorShift</code> component now at my disposal, I can now trust it’s behavior, making future\ntransitions easier to implement.</p>\n</li>\n</ul>',
frontmatter:{title:"Exposing CSS Hidden Complexities with React",date:"November 18, 2017"}}},pathContext:{slug:"/exposing-css-hidden-complexities-with-react/",previous:{fields:{slug:"/the-state-of-css/"},frontmatter:{title:"The State of CSS"}},next:{fields:{slug:"/software-development-is-a-team-sport/"},frontmatter:{title:"Software Development is a Team Sport"}}}}}});
//# sourceMappingURL=path---exposing-css-hidden-complexities-with-react-dfbdb0521b537ba26eb1.js.map